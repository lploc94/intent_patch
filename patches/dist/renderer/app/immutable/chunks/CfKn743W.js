import{c as Nt,p as w,i as m,b as dt,a as Vt,u as Tt}from"./CKZOhV4i.js";import{d as Bt,p as Gt,o as Jt,A as Xt,u as nt,f as b,v as A,c as f,r as u,s as M,e as z,b as s,i as Zt,g as t,k as Y,Z as Yt,j as h,w as y,q as N,y as ke,a as H,h as ee,z as Qt,av as Mt,l as $t,n as Ct}from"./FWapvpP5.js";import{c as ne,e as Ve,i as er}from"./B5-SBSV9.js";import{c as pe,a as $,b as Re,F as W,R as jt,s as _t,M as Dt,P as Rt,U as tr,g as pt,V as It,f as Ot,d as Lt,m as rr}from"./_0HQXJs9.js";import{A as ar}from"./uOTxuk7I.js";import{P as zt,m as ce,s as Ut,g as nr}from"./BTPDcoPQ.js";import{B as St}from"./B07lkru-.js";import{t as or,s as sr}from"./45WHxSWz.js";import{b as mt,r as Ft,p as Pt,c as Et}from"./B-7-Y0L_.js";import{a as At}from"./CA0vlnYV.js";import{c as lr}from"./DvyKzjFb.js";import{n as ir}from"./Dt44gyZA.js";import{t as Ht}from"./BPmiYELv.js";class dr{async invoke(v,T){try{if(typeof window<"u"&&window.electronAPI){const I=await window.electronAPI.invoke(v,T);return this.commandResponseToResult(I)}return{ok:!1,error:"IPC not available"}}catch(I){return{ok:!1,error:I instanceof Error?I.message:"IPC call failed"}}}commandResponseToResult(v){return v.success&&v.data!==void 0?{ok:!0,data:v.data}:{ok:!1,error:v.error||"Unknown error"}}async setModel(v,T,I){return this.invoke(ar.SET_MODEL,{agentId:v,modelId:T,workspaceId:I})}}const ur=new dr;var vr=b('<div class="my-1 h-px bg-border"></div>'),cr=b("<div><!></div>"),fr=b("<div><!></div>"),gr=b('<img alt="" class="h-5 w-5 rounded-full shrink-0"/>'),mr=b('<span class="text-muted-foreground"> </span>'),pr=b('<span class="text-[10px] text-muted-foreground/60"> </span>'),_r=b('<span class="text-xs text-muted-foreground/60"> </span>'),hr=b('<!> <!> <!> <div class="flex-1 min-w-0 truncate"><span> </span> <!></div> <!> <!> <!>',1),br=b('<div data-submenu="" role="menu" tabindex="-1"></div>'),xr=b('<div class="relative"><button type="button"><!></button> <!></div>'),wr=b("<span> </span> <!>",1),yr=b("<div><!></div>"),kr=b('<div class="border-b border-border w-full"><input type="text" class="w-full bg-transparent px-2.5 py-2 text-sm placeholder:text-muted-foreground/50 outline-none border-none ring-0 focus:ring-0! focus:outline-none!"/></div>'),Mr=b("<div><!> </div>"),Cr=b("<div><!> <!></div>"),Ir=b('<div class="px-2 py-4 text-center text-sm text-muted-foreground">No results found</div>'),Lr=b('<div class="border-t border-border px-2 py-2.5"><!></div>'),Sr=b('<div role="listbox" tabindex="-1"><!> <!> <div class="max-h-[300px] overflow-y-auto py-1x"><!> <!></div> <!></div>'),Pr=b("<div><!></div>"),Er=b('<div class="border-b border-border w-full shrink-0"><input type="text" class="w-full bg-transparent px-2.5 py-2 text-sm placeholder:text-muted-foreground/50 outline-none border-none ring-0 focus:ring-0! focus:outline-none!"/></div>'),Ar=b("<div><!> </div>"),Dr=b("<div><!> <!></div>"),Rr=b('<div class="px-2 py-4 text-center text-sm text-muted-foreground">No results found</div>'),Or=b('<div class="border-t border-border shrink-0"><!></div>'),zr=b('<div role="listbox" tabindex="-1"><!> <!> <div class="flex-1 min-h-0 overflow-y-auto py-1x"><!> <!></div> <!></div>'),Ur=b('<div><button type="button" aria-haspopup="listbox"><!></button> <!></div> <!>',1);function Wt(Je,v){if(new.target)return Nt({component:Wt,...Je});Gt(v,!0);const T=(e,a=Qt)=>{var c=N(),k=A(c);{var U=F=>{var L=vr();s(F,L)},q=F=>{var L=xr(),g=f(L);g.__click=l=>Se(a(),l);var D=f(g);{var j=l=>{var i=N(),n=A(i);{let o=H(()=>({option:a(),selected:Pe(a().value),highlighted:!1}));ke(n,xe,()=>t(o))}s(l,i)},G=l=>{var i=hr(),n=A(i);{var o=C=>{var O=cr(),me=f(O);{var lt=ie=>{W(ie,{get icon(){return pt},class:"h-2.5 w-2.5 text-primary-foreground"})};m(me,ie=>{a().checked&&ie(lt)})}u(O),z(ie=>$(O,1,ie),[()=>pe(ne("h-4 w-4 shrink-0 rounded border border-muted-foreground/30","flex items-center justify-center",a().checked?"bg-primary border-primary":"bg-transparent"))]),s(C,O)},d=C=>{var O=N(),me=A(O);{var lt=ie=>{var gt=fr(),qt=f(gt);{var Kt=it=>{W(it,{get icon(){return pt},class:"h-3 w-3 text-foreground"})};m(qt,it=>{Pe(a().value)&&it(Kt)})}u(gt),z(it=>$(gt,1,it),[()=>pe(ne("h-5 w-5 shrink-0 mr-1 rounded-md border border-muted-foreground/30","flex items-center justify-center bg-transparent"))]),s(ie,gt)};m(me,ie=>{de()&&ie(lt)},!0)}s(C,O)};m(n,C=>{a().type==="toggle"?C(o):C(d,!1)})}var p=M(n,2);{var S=C=>{var O=gr();z(()=>Re(O,"src",a().avatar)),s(C,O)};m(p,C=>{a().avatar&&C(S)})}var E=M(p,2);{var V=C=>{W(C,{get icon(){return a().icon},class:"h-4 w-4 shrink-0 text-muted-foreground"})};m(E,C=>{a().icon&&C(V)})}var ae=M(E,2),Ee=f(ae),Z=f(Ee,!0);u(Ee);var Q=M(Ee,2);{var K=C=>{var O=mr(),me=f(O);u(O),z(()=>ee(me,`Â· ${a().description??""}`)),s(C,O)};m(Q,C=>{a().description&&C(K)})}u(ae);var ve=M(ae,2);{var Ae=C=>{var O=pr(),me=f(O,!0);u(O),z(()=>ee(me,a().endLabel)),s(C,O)};m(ve,C=>{a().endLabel&&C(Ae)})}var De=M(ve,2);{var He=C=>{var O=_r(),me=f(O,!0);u(O),z(()=>ee(me,a().shortcut)),s(C,O)};m(De,C=>{a().shortcut&&C(He)})}var Ne=M(De,2);{var at=C=>{W(C,{get icon(){return tr},class:"h-3 w-3 shrink-0 text-muted-foreground"})},Ke=C=>{var O=N(),me=A(O);{var lt=ie=>{W(ie,{get icon(){return pt},class:"h-4 w-4 shrink-0 text-foreground"})};m(me,ie=>{!de()&&!a().type&&Pe(a().value)&&ie(lt)},!0)}s(C,O)};m(Ne,C=>{a().type==="submenu"?C(at):C(Ke,!1)})}z(()=>ee(Z,a().label)),s(l,i)};m(D,l=>{xe()?l(j):l(G,!1)})}u(g);var P=M(g,2);{var R=l=>{zt(l,{zIndex:101,children:(i,n)=>{var o=br();Ve(o,21,()=>a().children,d=>d.value,(d,p)=>{T(d,()=>t(p))}),u(o),z(d=>{$(o,1,d),_t(o,t(st))},[()=>pe(ne("min-w-45 overflow-hidden rounded-md border border-border","bg-popover text-popover-foreground shadow-md py-1"))]),Mt("mouseleave",o,()=>h(B,null)),s(i,o)},$$slots:{default:!0}})};m(P,l=>{var i;a().type==="submenu"&&((i=a().children)!=null&&i.length)&&t(B)===a().value&&l(R)})}u(L),z((l,i)=>{g.disabled=a().disabled,$(g,1,l),Re(g,"role",a().type==="submenu"?"menuitem":"option"),Re(g,"aria-selected",i),Re(g,"aria-haspopup",a().type==="submenu"?"menu":void 0),Re(g,"aria-expanded",a().type==="submenu"?t(B)===a().value:void 0)},[()=>pe(ne("relative flex items-center gap-1.5 px-3 py-2 text-sm w-full text-left","cursor-pointer select-none transition-colors","hover:bg-muted/40 focus:bg-muted/40 focus:outline-none","disabled:pointer-events-none disabled:opacity-50",a().class)),()=>a().type!=="submenu"?Pe(a().value):void 0]),Mt("mouseenter",L,l=>bt(a(),l)),Mt("mouseleave",L,et),s(F,L)};m(k,F=>{a().type==="separator"?F(U):F(q,!1)})}s(e,c)};let I=w(v,"value",15),Me=w(v,"options",23,()=>[]),X=w(v,"groups",23,()=>[]),_e=w(v,"placeholder",7,"Select..."),oe=w(v,"portal",7,!1),J=w(v,"searchable",7,!0),de=w(v,"multiple",7,!1),te=w(v,"disabled",7,!1),x=w(v,"open",15,!1),Te=w(v,"variant",7,"default"),Be=w(v,"size",7,"md"),Ge=w(v,"class",7,""),Oe=w(v,"triggerClass",7,""),ze=w(v,"contentClass",7,""),Ce=w(v,"headerClass",7,""),he=w(v,"onchange",7),be=w(v,"onopenchange",7),Ie=w(v,"trigger",7),xe=w(v,"item",7),re=w(v,"groupHeader",7),se=w(v,"header",7),we=w(v,"footer",7),fe=w(v,"empty",7),Ze=Y(null),ot=Y(null),Le=Y(""),ue=Y(""),Xe=Y(null),le=Y(null),B=Y(null),st=Y("");const je=H(()=>X().length>0?X().flatMap(e=>e.options):Me()),Ye=H(()=>{if(!t(ue))return Me();const e=t(ue).toLowerCase();return Me().filter(a=>{var c;return a.label.toLowerCase().includes(e)||((c=a.description)==null?void 0:c.toLowerCase().includes(e))})}),Qe=H(()=>{if(!t(ue))return X();const e=t(ue).toLowerCase();return X().map(a=>({...a,options:a.options.filter(c=>{var k;return c.label.toLowerCase().includes(e)||((k=c.description)==null?void 0:k.toLowerCase().includes(e))})})).filter(a=>a.options.length>0)}),Ue=H(()=>{var e,a;if(I()){if(Array.isArray(I())){if(I().length===0)return;if(I().length===1){const c=I()[0];return(e=t(je).find(k=>k.value===c))==null?void 0:e.label}return`${I().length} selected`}return(a=t(je).find(c=>c.value===I()))==null?void 0:a.label}});async function ht(){var e,a;te()||x()||(x(!0),(e=be())==null||e(!0),oe()&&t(Ze)&&Fe(),await Yt(),J()&&((a=t(le))==null||a.focus()))}function Fe(){if(!t(Ze)||!x()||!oe())return;const e=t(Ze).getBoundingClientRect(),a=window.innerHeight,c=8,k=a-e.bottom-c,U=e.top-c,q=300;if(k<q&&U>k){const F=Math.min(q,U);h(Le,`position: fixed; bottom: ${a-e.top+4}px; left: ${e.left}px; min-width: ${e.width}px; max-height: ${F}px;`)}else{const F=Math.min(q,k);h(Le,`position: fixed; top: ${e.bottom+4}px; left: ${e.left}px; min-width: ${e.width}px; max-height: ${F}px;`)}}function $e(){var e;x()&&(x(!1),h(ue,""),h(B,null),(e=be())==null||e(!1))}function Se(e,a){var c,k,U,q;if(!e.disabled&&e.type!=="separator"&&!(e.type==="submenu"&&((c=e.children)!=null&&c.length))){if(e.onclick){e.onclick(),$e();return}if(e.type==="toggle"){(k=he())==null||k(e.value,a);return}if(de()){const F=Array.isArray(I())?I():I()?[I()]:[],g=F.includes(e.value)?F.filter(D=>D!==e.value):[...F,e.value];I(g),(U=he())==null||U(g,a)}else I(e.value),(q=he())==null||q(e.value,a),$e()}}function bt(e,a){var c;if(e.type==="submenu"&&((c=e.children)!=null&&c.length)){h(B,e.value,!0);const U=a.currentTarget.getBoundingClientRect();h(st,`position: fixed; top: ${U.top}px; left: ${U.right+4}px;`)}}function et(e){const a=e.relatedTarget;a!=null&&a.closest("[data-submenu]")||h(B,null)}function Pe(e){return Array.isArray(I())?I().includes(e):I()===e}function ye(e){var U;if(!t(Xe)||!x())return;const a=e.target,c=t(Xe).contains(a),k=((U=t(ot))==null?void 0:U.contains(a))??!1;!c&&!k&&$e()}function We(e){e.key==="Escape"&&(e.preventDefault(),$e())}Jt(()=>{document.addEventListener("mousedown",ye,!0),window.addEventListener("scroll",Fe,!0),window.addEventListener("resize",Fe)}),Xt(()=>{document.removeEventListener("mousedown",ye,!0),window.removeEventListener("scroll",Fe,!0),window.removeEventListener("resize",Fe)}),nt(()=>{x()&&oe()&&requestAnimationFrame(()=>Fe())});const ut={xs:"h-6 px-2 text-xs",sm:"h-8 px-2.5 text-sm",md:"h-9 px-3 text-sm",lg:"h-10 px-4 text-base"},vt={default:"border border-input bg-background hover:bg-muted/50",ghost:"border-0 bg-transparent hover:bg-muted/50",outline:"border border-input bg-transparent hover:bg-muted/50",inline:"border-0 bg-transparent p-0 h-auto hover:text-foreground"},tt=H(()=>X().length>0?t(Qe).length>0:t(Ye).length>0);var rt={get value(){return I()},set value(e){I(e),y()},get options(){return Me()},set options(e=[]){Me(e),y()},get groups(){return X()},set groups(e=[]){X(e),y()},get placeholder(){return _e()},set placeholder(e="Select..."){_e(e),y()},get portal(){return oe()},set portal(e=!1){oe(e),y()},get searchable(){return J()},set searchable(e=!0){J(e),y()},get multiple(){return de()},set multiple(e=!1){de(e),y()},get disabled(){return te()},set disabled(e=!1){te(e),y()},get open(){return x()},set open(e=!1){x(e),y()},get variant(){return Te()},set variant(e="default"){Te(e),y()},get size(){return Be()},set size(e="md"){Be(e),y()},get class(){return Ge()},set class(e=""){Ge(e),y()},get triggerClass(){return Oe()},set triggerClass(e=""){Oe(e),y()},get contentClass(){return ze()},set contentClass(e=""){ze(e),y()},get headerClass(){return Ce()},set headerClass(e=""){Ce(e),y()},get onchange(){return he()},set onchange(e){he(e),y()},get onopenchange(){return be()},set onopenchange(e){be(e),y()},get trigger(){return Ie()},set trigger(e){Ie(e),y()},get item(){return xe()},set item(e){xe(e),y()},get groupHeader(){return re()},set groupHeader(e){re(e),y()},get header(){return se()},set header(e){se(e),y()},get footer(){return we()},set footer(e){we(e),y()},get empty(){return fe()},set empty(e){fe(e),y()},$set:Tt,$on:(e,a)=>Vt(v,e,a)},ct=Ur(),qe=A(ct),ge=f(qe);ge.__click=ht,ge.__keydown=We;var xt=f(ge);{var ft=e=>{var a=N(),c=A(a);ke(c,Ie,()=>({open:x(),value:I()})),s(e,a)},wt=e=>{var a=wr(),c=A(a),k=f(c,!0);u(c);var U=M(c,2);W(U,{get icon(){return jt},class:"h-2! w-2! opacity-50 shrink-0"}),z(()=>{$(c,1,`truncate text-left flex-1 ${t(Ue)?"":"text-muted-foreground"}`),ee(k,t(Ue)??_e())}),s(e,a)};m(xt,e=>{Ie()?e(ft):e(wt,!1)})}u(ge),dt(ge,e=>h(Ze,e),()=>t(Ze));var yt=M(ge,2);{var kt=e=>{var a=Sr();a.__keydown=We;var c=f(a);{var k=l=>{var i=yr(),n=f(i);ke(n,se),u(i),z(o=>$(i,1,o),[()=>pe(ne("border-b border-border",Ce()))]),s(l,i)};m(c,l=>{se()&&l(k)})}var U=M(c,2);{var q=l=>{var i=kr(),n=f(i);Dt(n),n.__input=o=>h(ue,o.currentTarget.value,!0),n.__keydown=We,dt(n,o=>h(le,o),()=>t(le)),u(i),z(()=>{Re(n,"placeholder",_e()),Rt(n,t(ue))}),s(l,i)};m(U,l=>{J()&&l(q)})}var F=M(U,2),L=f(F);{var g=l=>{var i=N(),n=A(i);Ve(n,19,()=>t(Qe),o=>o.key,(o,d,p)=>{var S=Cr(),E=f(S);{var V=Z=>{var Q=N(),K=A(Q);ke(K,re,()=>({group:t(d)})),s(Z,Q)},ae=Z=>{var Q=N(),K=A(Q);{var ve=Ae=>{var De=Mr(),He=f(De);{var Ne=Ke=>{W(Ke,{get icon(){return t(d).icon},class:"inline-block mr-1.5 h-3 w-3"})};m(He,Ke=>{t(d).icon&&Ke(Ne)})}var at=M(He);u(De),z(()=>{$(De,1,`px-3 ${t(p)===0?"":"pt-3 border-t border-border"} py-1.5 text-xs font-medium text-muted-foreground/70 uppercase tracking-wider`),ee(at,` ${t(d).label??""}`)}),s(Ae,De)};m(K,Ae=>{t(d).label&&Ae(ve)},!0)}s(Z,Q)};m(E,Z=>{re()?Z(V):Z(ae,!1)})}var Ee=M(E,2);Ve(Ee,17,()=>t(d).options,Z=>Z.value,(Z,Q)=>{T(Z,()=>t(Q))}),u(S),s(o,S)}),s(l,i)},D=l=>{var i=N(),n=A(i);Ve(n,17,()=>t(Ye),o=>o.value,(o,d)=>{T(o,()=>t(d))}),s(l,i)};m(L,l=>{X().length>0?l(g):l(D,!1)})}var j=M(L,2);{var G=l=>{var i=N(),n=A(i);{var o=p=>{var S=N(),E=A(S);ke(E,fe),s(p,S)},d=p=>{var S=Ir();s(p,S)};m(n,p=>{fe()?p(o):p(d,!1)})}s(l,i)};m(j,l=>{t(tt)||l(G)})}u(F);var P=M(F,2);{var R=l=>{var i=Lr(),n=f(i);ke(n,we),u(i),s(l,i)};m(P,l=>{we()&&l(R)})}u(a),z(l=>$(a,1,l),[()=>pe(ne("absolute top-full left-0 z-50 mt-1 min-w-full w-max","overflow-hidden rounded-md border border-border","bg-popover text-popover-foreground shadow-md",ze()))]),or(3,a,()=>sr,()=>({duration:150})),s(e,a)};m(yt,e=>{x()&&!oe()&&e(kt)})}u(qe),dt(qe,e=>h(Xe,e),()=>t(Xe));var r=M(qe,2);{var _=e=>{zt(e,{zIndex:100,children:(a,c)=>{var k=zr();k.__keydown=We;var U=f(k);{var q=n=>{var o=Pr(),d=f(o);ke(d,se),u(o),z(p=>$(o,1,p),[()=>pe(ne("border-b border-border shrink-0",Ce()))]),s(n,o)};m(U,n=>{se()&&n(q)})}var F=M(U,2);{var L=n=>{var o=Er(),d=f(o);Dt(d),d.__input=p=>h(ue,p.currentTarget.value,!0),d.__keydown=We,dt(d,p=>h(le,p),()=>t(le)),u(o),z(()=>{Re(d,"placeholder",_e()),Rt(d,t(ue))}),s(n,o)};m(F,n=>{J()&&n(L)})}var g=M(F,2),D=f(g);{var j=n=>{var o=N(),d=A(o);Ve(d,19,()=>t(Qe),p=>p.key,(p,S,E)=>{var V=Dr(),ae=f(V);{var Ee=K=>{var ve=N(),Ae=A(ve);ke(Ae,re,()=>({group:t(S)})),s(K,ve)},Z=K=>{var ve=N(),Ae=A(ve);{var De=He=>{var Ne=Ar(),at=f(Ne);{var Ke=O=>{W(O,{get icon(){return t(S).icon},class:"inline-block mr-1.5 h-3 w-3"})};m(at,O=>{t(S).icon&&O(Ke)})}var C=M(at);u(Ne),z(()=>{$(Ne,1,`px-3 ${t(E)===0?"":"pt-3 border-t border-border"} py-1.5 text-xs font-medium text-muted-foreground/70 uppercase tracking-wider`),ee(C,` ${t(S).label??""}`)}),s(He,Ne)};m(Ae,He=>{t(S).label&&He(De)},!0)}s(K,ve)};m(ae,K=>{re()?K(Ee):K(Z,!1)})}var Q=M(ae,2);Ve(Q,17,()=>t(S).options,K=>K.value,(K,ve)=>{T(K,()=>t(ve))}),u(V),s(p,V)}),s(n,o)},G=n=>{var o=N(),d=A(o);Ve(d,17,()=>t(Ye),p=>p.value,(p,S)=>{T(p,()=>t(S))}),s(n,o)};m(D,n=>{X().length>0?n(j):n(G,!1)})}var P=M(D,2);{var R=n=>{var o=N(),d=A(o);{var p=E=>{var V=N(),ae=A(V);ke(ae,fe),s(E,V)},S=E=>{var V=Rr();s(E,V)};m(d,E=>{fe()?E(p):E(S,!1)})}s(n,o)};m(P,n=>{t(tt)||n(R)})}u(g);var l=M(g,2);{var i=n=>{var o=Or(),d=f(o);ke(d,we),u(o),s(n,o)};m(l,n=>{we()&&n(i)})}u(k),dt(k,n=>h(ot,n),()=>t(ot)),z(n=>{$(k,1,n),_t(k,t(Le))},[()=>pe(ne("w-max flex flex-col","overflow-hidden rounded-md border border-border","bg-popover text-popover-foreground shadow-md",ze()))]),s(a,k)},$$slots:{default:!0}})};m(r,e=>{x()&&oe()&&e(_)})}return z((e,a)=>{$(qe,1,e),ge.disabled=te(),$(ge,1,a),Re(ge,"aria-expanded",x())},[()=>pe(ne("relative inline-block",Ge())),()=>pe(ne("inline-flex items-center gap-2 rounded-md transition-colors cursor-pointer","focus:outline-none focus-visible:outline-none","disabled:cursor-not-allowed disabled:opacity-50",ut[Be()],vt[Te()],Oe()))]),s(Je,ct),Zt(rt)}Bt(["click","keydown","input"]);const Fr={prefix:"fas",iconName:"cog",icon:[16,16,[],"e001","M6.5 2.25a.75.75 0 0 0-1.5 0v3a.75.75 0 0 0 1.5 0V4.5h6.75a.75.75 0 0 0 0-1.5H6.5v-.75ZM11 6.5a.75.75 0 0 0-1.5 0v3a.75.75 0 0 0 1.5 0v-.75h2.25a.75.75 0 0 0 0-1.5H11V6.5ZM5.75 10a.75.75 0 0 1 .75.75v.75h6.75a.75.75 0 0 1 0 1.5H6.5v.75a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 .75-.75ZM2.75 7.25H8.5v1.5H2.75a.75.75 0 0 1 0-1.5ZM4 3H2.75a.75.75 0 0 0 0 1.5H4V3ZM2.75 11.5H4V13H2.75a.75.75 0 0 1 0-1.5Z"]};var Hr=b('<!> <span class="flex-1 text-left truncate"> </span>',1),Nr=b('<span class="flex items-center gap-1.5"><!> <span class="text-xs truncate"> </span></span>'),Vr=b('<!> <span class="truncate"> </span>',1),Tr=b("<span><!></span> <!>",1),Br=b('<div class="px-2.5 py-2 border-b border-border"><div class="flex items-start gap-2"><!> <div class="min-w-0"><div class="text-xs font-medium text-foreground"> </div> <div class="text-[11px] text-muted-foreground mt-0.5"> </div></div></div></div>'),Gr=b('<div class="h-2.5 bg-muted/30 rounded animate-pulse"></div>'),Zr=b('<div class="flex items-center gap-2 w-full pointer-events-none"><div class="flex-1 min-w-0 flex flex-col gap-1"><div class="h-3.5 bg-muted/40 rounded animate-pulse"></div> <!></div></div>'),jr=b('<div class="text-[10px] text-muted-foreground truncate"> </div>'),Wr=b('<div class="flex items-center gap-2 w-full"><div class="flex-1 min-w-0"><div> </div> <!></div> <!></div>'),qr=b('<span class="truncate">Models from <span class="font-medium"> </span></span>'),Kr=b('<div class="flex items-center w-full pl-3 pr-1.5 gap-2"><!> <!></div>'),Jr=b('<div class="h-8 bg-muted/50 rounded-md animate-pulse"></div>'),Xr=b('<div class="flex flex-col gap-1"></div>'),Yr=b('<div class="flex flex-col items-center gap-2"><div class="flex items-center gap-1.5 text-destructive-foreground"><!> <span class="text-xs">Failed to load models</span></div> <button type="button" class="flex items-center gap-1.5 px-2 py-1 text-xs rounded-md bg-muted hover:bg-muted/80 text-foreground transition-colors"><!> Retry</button></div>'),Qr=b('<div class="flex flex-col items-center gap-2 text-muted-foreground"><span class="text-xs">No models available</span> <button type="button" class="flex items-center gap-1.5 px-2 py-1 text-xs rounded-md bg-muted hover:bg-muted/80 text-foreground transition-colors"><!> Retry</button></div>'),$r=b('<div class="px-3 py-3"><!></div>');function ea(Je,v){if(new.target)return Nt({component:ea,...Je});Gt(v,!0);const T=lr("ModelPicker");let I=w(v,"selectedModel",15),Me=w(v,"onModelChange",7,()=>{}),X=w(v,"isCompact",7,!1),_e=w(v,"isLocked",7,!1),oe=w(v,"deferUpdate",7,!1),J=w(v,"variant",7,"ghost-light"),de=w(v,"size",7,"sm"),te=w(v,"workspaceId",7),x=w(v,"agentId",7),Te=w(v,"showManageLink",7,!0),Be=w(v,"portal",7,!0),Ge=w(v,"triggerClass",7,""),Oe=w(v,"defaultModelId",7),ze=w(v,"showDefaultOption",7,!1),Ce=w(v,"updateGlobalStore",7,!1),he=Y(null);const be=H(()=>{if(x()){const r=Ut.getSession(x());if(r){const _=nr(r);if(_)return Et(_).id}}return mt.activeProviderId}),Ie=H(()=>!1);let xe=Y(null),re=Y(!1),se=Y(null);nt(()=>{t(be);h(xe,null),h(re,!1),h(se,null)});const we=H(()=>t(xe)??ce.availableModels),fe=H(()=>t(Ie)?t(re):ce.isLoadingModels),Ze=H(()=>t(Ie)?t(se):ce.loadError),ot=H(()=>Et(t(be)).displayName);let Le=Y(!1);async function ue(){if(t(Ie)){h(re,!0),h(se,null);try{h(xe,await ce.getModelsForProvider(t(be)),!0)}catch(r){h(se,r instanceof Error?r.message:"Failed to load models",!0)}finally{h(re,!1)}}else await ce.retryLoadModels()}async function Xe(){if(!t(Le)){h(Le,!0);try{t(Ie)?h(xe,await ce.getModelsForProvider(t(be)),!0):await ce.retryLoadModels()}finally{h(Le,!1)}}}const le="__use_default__";let B=Y($t(I()));nt(()=>{I()!==t(B)&&h(B,I(),!0)}),nt(()=>{if(!oe()&&t(he)){const r=t(he);h(he,null),T.info("Applying deferred model update:",{model:r,agentId:x()}),st(r)}});async function st(r){if(x()&&te())try{const _=await ur.setModel(x(),r,te());if(_.ok&&_.data.success)T.info("Updated agent model via IPC:",{agentId:x(),model:r});else{const e=_.ok?_.data.error:_.error;T.warn("Failed to update agent model:",{agentId:x(),model:r,error:e}),e&&Ht.error(e,{duration:6e3})}}catch(_){T.error("Error updating agent model:",{agentId:x(),model:r,error:_})}}async function je(r){var _;if(T.debug("Model selected:",{model:r,previousModel:t(B),workspaceId:te(),agentId:x(),deferUpdate:oe(),updateGlobalStore:Ce()}),h(B,r,!0),I(r),r!==void 0){if((_=Me())==null||_(r),!Ce())return;ce.selectModel(r),te()&&(ce.setWorkspaceDefaultModel(te(),r),T.debug("Updated workspace model:",{workspaceId:te(),model:r})),x()&&te()&&(Ut.updateSession(x(),{model:r}),T.debug("Updated local session model:",{agentId:x(),model:r}),oe()?(h(he,r,!0),T.info("Model update deferred until streaming ends:",{model:r,agentId:x()})):await st(r))}}const Ye=H(()=>t(B)!==void 0&&t(B)!==le&&t(B)!=="undefined"&&Pt(t(B)).modelId!=="default");function Qe(r){var _;if(r)return((_=t(we).find(e=>e.value===r))==null?void 0:_.label)||r}const Ue=H(()=>{var r;return t(Ye)?Qe(t(B))||"Default model":(Oe()?Qe(Oe()):void 0)||((r=t(we)[0])==null?void 0:r.label)||"Default model"}),ht=H(()=>X()?"icon":de()),Fe=H(()=>ne(X()?"h-8 w-8 p-0 flex items-center justify-center":de()==="xs"?"":"h-8 min-w-[140px] justify-between","text-muted-foreground hover:text-foreground transition-colors")),$e={value:le,label:"Default model",description:"Let the specialist choose the best model"},Se=H(()=>[...ze()?[$e]:[],...t(we).map(r=>({value:r.value,label:r.label,description:r.description}))]),bt=H(()=>t(B)??le),et=H(()=>t(fe)||!t(Ye)||!t(B)?!1:!new Set(t(Se).map(_=>_.value)).has(t(B))),Pe="workspaces-model-fallback:";let ye=Y(null);if(x())try{const r=localStorage.getItem(Pe+x());r&&(h(ye,JSON.parse(r),!0),T.debug("Loaded fallback info from localStorage:",{agentId:x(),fallback:r}))}catch{localStorage.removeItem(Pe+x())}function We(r){if(h(ye,r,!0),x())try{localStorage.setItem(Pe+x(),JSON.stringify(r))}catch{}}function ut(){h(ye,null),x()&&localStorage.removeItem(Pe+x())}const vt=H(()=>!!x()&&(t(et)||t(ye)!==null)),tt=H(()=>t(et)?{title:`${t(B)||"Selected model"} is no longer available`,description:"Pick another model to continue."}:t(ye)?{title:`${t(ye).fromModel} is no longer available`,description:`Switched to ${t(ye).toModel}.`}:null);nt(()=>{if(!x()||!t(et)||t(Se).length===0)return;const r=t(B)||"Selected model",_=t(Se).filter(g=>g.value!==le),e=_.map(g=>g.value),a=Ft(At.UI_MODEL_PREFERENCE,e),c=a?_.find(g=>g.value===a):_.find(g=>g.value===ce.selectedModel)??_[0];if(!c)return;const k=c.label||c.value;T.info("Auto-switching from unavailable model:",{unavailableModel:r,fallbackModel:c.value});const{providerId:U,modelId:q}=Pt(r),F=Et(mt.activeProviderId).id;r===At.UI_INITIAL_MODEL||U!==F||t(Se).some(g=>{const{modelId:D}=Pt(g.value);return D===q})?T.info("Skipping fallback warning (provider switch detected)",{unavailableModel:r,unavailableBaseId:q}):(We({fromModel:r,toModel:k}),Ht.info(`${r} is no longer available. Switched to ${k}.`,{duration:5e3})),je(c.value)}),nt(()=>{if(x()||!t(et)||!t(fe)&&t(Se).length===0)return;const r=t(Se).filter(c=>c.value!==le),_=r.map(c=>c.value),e=Ft(At.UI_MODEL_PREFERENCE,_),a=e?r.find(c=>c.value===e):r.find(c=>c.value===ce.selectedModel)??r[0];a&&(T.info("Workspace initializer: falling back from unavailable model to preferred default",{unavailableModel:t(B),fallbackModel:a.value}),je(a.value))});let rt=Y(!1);function ct(){ut()}function qe(r){const _=r;ut(),je(_===le?void 0:_)}function ge(){_e()||h(rt,!0)}var xt={clearFallbackWarning:ct,open:ge,get selectedModel(){return I()},set selectedModel(r){I(r),y()},get onModelChange(){return Me()},set onModelChange(r=()=>{}){Me(r),y()},get isCompact(){return X()},set isCompact(r=!1){X(r),y()},get isLocked(){return _e()},set isLocked(r=!1){_e(r),y()},get deferUpdate(){return oe()},set deferUpdate(r=!1){oe(r),y()},get variant(){return J()},set variant(r="ghost-light"){J(r),y()},get size(){return de()},set size(r="sm"){de(r),y()},get workspaceId(){return te()},set workspaceId(r){te(r),y()},get agentId(){return x()},set agentId(r){x(r),y()},get showManageLink(){return Te()},set showManageLink(r=!0){Te(r),y()},get portal(){return Be()},set portal(r=!0){Be(r),y()},get triggerClass(){return Ge()},set triggerClass(r=""){Ge(r),y()},get defaultModelId(){return Oe()},set defaultModelId(r){Oe(r),y()},get showDefaultOption(){return ze()},set showDefaultOption(r=!1){ze(r),y()},get updateGlobalStore(){return Ce()},set updateGlobalStore(r=!1){Ce(r),y()},$set:Tt,$on:(r,_)=>Vt(v,r,_)},ft=N(),wt=A(ft);{var yt=r=>{{let _=H(()=>ne(t(Fe),"cursor-default")),e=H(()=>`Model locked: ${t(Ue)}`);St(r,{get variant(){return J()},get size(){return t(ht)},get class(){return t(_)},get title(){return t(e)},disabled:!0,children:(a,c)=>{var k=N(),U=A(k);{var q=L=>{W(L,{get icon(){return It},class:"h-4 w-4"})},F=L=>{var g=N(),D=A(g);{var j=P=>{var R=Hr(),l=A(R);W(l,{get icon(){return It},class:"h-3.5 w-3.5"});var i=M(l,2),n=f(i,!0);u(i),z(()=>ee(n,t(Ue))),s(P,R)},G=P=>{var R=Nr(),l=f(R);W(l,{get icon(){return It},class:"h-3.5 w-3.5"});var i=M(l,2),n=f(i,!0);u(i),u(R),z(()=>ee(n,t(Ue))),s(P,R)};m(D,P=>{de()==="xs"?P(j):P(G,!1)},!0)}s(L,g)};m(U,L=>{X()?L(q):L(F,!1)})}s(a,k)},$$slots:{default:!0}})}},kt=r=>{{const _=(L,g)=>{var D=Tr(),j=A(D),G=f(j);{var P=n=>{W(n,{get icon(){return Fr},class:"h-4 w-4"})},R=n=>{var o=Vr(),d=A(o);{var p=V=>{W(V,{get icon(){return Ot},class:"h-3 w-3 text-amber-600 shrink-0"})};m(d,V=>{t(vt)&&V(p)})}var S=M(d,2),E=f(S,!0);u(S),z(()=>ee(E,t(Ue))),s(n,o)};m(G,n=>{X()?n(P):n(R,!1)})}u(j);var l=M(j,2);{var i=n=>{W(n,{get icon(){return jt},class:"h-2 w-2 opacity-50 shrink-0"})};m(l,n=>{(J()==="outline"||J()==="default")&&n(i)})}z(n=>{$(j,1,n),Re(j,"title",t(Ue))},[()=>pe(ne("inline-flex items-center gap-1 truncate min-w-0",(J()==="outline"||J()==="default")&&"flex-1"))]),s(L,D)},e=L=>{var g=N(),D=A(g);{var j=G=>{var P=Br(),R=f(P),l=f(R);W(l,{get icon(){return Ot},class:"h-4 w-4 text-amber-600 mt-0.5 shrink-0"});var i=M(l,2),n=f(i),o=f(n,!0);u(n);var d=M(n,2),p=f(d,!0);u(d),u(i),u(R),u(P),z(()=>{ee(o,t(tt).title),ee(p,t(tt).description)}),s(G,P)};m(D,G=>{t(vt)&&t(tt)&&G(j)})}s(L,g)},a=(L,g)=>{let D=()=>g==null?void 0:g().option,j=()=>g==null?void 0:g().selected;var G=N(),P=A(G);{var R=i=>{var n=Zr(),o=f(n),d=f(o),p=M(d,2);{var S=E=>{var V=Gr();z(ae=>_t(V,`width: ${ae??""}%`),[()=>35+(D().value.charCodeAt(1)||0)%3*12]),s(E,V)};m(p,E=>{D().description&&E(S)})}u(o),u(n),z(E=>_t(d,`width: ${E??""}%`),[()=>55+(D().value.charCodeAt(0)||0)%4*12]),s(i,n)},l=i=>{var n=Wr(),o=f(n),d=f(o);let p;var S=f(d,!0);u(d);var E=M(d,2);{var V=Z=>{var Q=jr(),K=f(Q,!0);u(Q),z(()=>ee(K,D().description)),s(Z,Q)};m(E,Z=>{D().description&&Z(V)})}u(o);var ae=M(o,2);{var Ee=Z=>{W(Z,{get icon(){return pt},class:"text-xs text-muted-foreground shrink-0"})};m(ae,Z=>{j()&&Z(Ee)})}u(n),z(()=>{p=$(d,1,"truncate",null,p,{italic:D().value===le}),ee(S,D().label)}),s(i,n)};m(P,i=>{t(fe)?i(R):i(l,!1)})}s(L,G)},c=L=>{var g=N(),D=A(g);{var j=G=>{var P=Kr(),R=f(P);St(R,{variant:"plain",size:"xs",class:"flex-1 min-w-0 font-normal",onclick:()=>{h(rt,!1),ir({hash:"providers"})},title:"Change agent provider",children:(i,n)=>{var o=qr(),d=M(f(o)),p=f(d,!0);u(d),u(o),z(()=>ee(p,t(ot))),s(i,o)},$$slots:{default:!0}});var l=M(R,2);St(l,{variant:"ghost-light",size:"icon-xs",onclick:Xe,title:"Refresh models",get disabled(){return t(Le)},children:(i,n)=>{{let o=H(()=>t(Le)?"animate-spin":"");W(i,{get icon(){return Lt},size:10,get class(){return t(o)}})}},$$slots:{default:!0}}),u(P),s(G,P)};m(D,G=>{Te()&&G(j)})}s(L,g)},k=L=>{var g=$r(),D=f(g);{var j=P=>{var R=Xr();Ve(R,20,()=>Array(5),er,(l,i)=>{var n=Jr();s(l,n)}),u(R),s(P,R)},G=P=>{var R=N(),l=A(R);{var i=o=>{var d=Yr(),p=f(d),S=f(p);W(S,{get icon(){return rr},class:"h-3 w-3"}),Ct(2),u(p);var E=M(p,2);E.__click=ue;var V=f(E);W(V,{get icon(){return Lt},class:"h-3 w-3"}),Ct(),u(E),u(d),s(o,d)},n=o=>{var d=Qr(),p=M(f(d),2);p.__click=ue;var S=f(p);W(S,{get icon(){return Lt},class:"h-3 w-3"}),Ct(),u(p),u(d),s(o,d)};m(l,o=>{t(Ze)?o(i):o(n,!1)},!0)}s(P,R)};m(D,P=>{t(fe)?P(j):P(G,!1)})}u(g),s(L,g)};let U=H(()=>J()==="outline"?"outline":J()==="default"?"default":"ghost"),q=H(()=>de()==="xs"?"xs":"sm"),F=H(()=>ne("max-w-full",(J()==="outline"||J()==="default")&&"w-full justify-between",Ge()));Wt(r,{get value(){return t(bt)},get options(){return t(Se)},onchange:qe,get variant(){return t(U)},get size(){return t(q)},searchable:!1,class:"min-w-0",headerClass:"border-b-0!",get triggerClass(){return t(F)},contentClass:"min-w-[220px]",get portal(){return Be()},get open(){return t(rt)},set open(L){h(rt,L,!0)},trigger:_,header:e,item:a,footer:c,empty:k,$$slots:{trigger:!0,header:!0,item:!0,footer:!0,empty:!0}})}};m(wt,r=>{_e()?r(yt):r(kt,!1)})}return s(Je,ft),Zt(xt)}Bt(["click"]);export{Wt as D,ea as M};
